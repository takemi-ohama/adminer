# 開発AI向け指示書


# 1. ワークスペースの全体像の把握
* 回答やレポートは全て日本語で出力してください。
* このワークスペースはadminerをforkしたリポジトリで構成されています
* まずファイル全体を概観し、全体像を把握して下さい
* このプロジェクトでは、第一弾の目的として、bigqueryに接続するdriverプラグインを開発します
    * issues/report01.md を読み、実装方針を把握してください
    * さらにこの目的に必要な情報を収集してください
* 把握した結果をCLAUDE.mdとSerena MCPに記憶してください
* bigquery driver pluginの開発計画を作成し、issues/plan01.mdに出力してください

# 2. 開発用コンテナに必要なツールを追加
* 開発用のコンテナ(この環境)はcontainer/Dockerfileに定義されています。
* PHPなど、bigquery driver pluginの開発に必要なツールのインストール手順をこのDockerファイルに追加してください

# 3. 実装開始
* issues/plan01.md に従って実装を開始してください

# 4. e2eテスト用コンテナを作成してください。
* 実装されたbigquery pluginを使ったadminerコンテナによるe2eテストを実施するためのコンテナイメージを作成します。
* テスト用コンテナの定義、設定はcontainer/testsに作成します。
* この環境はcontainer/devで定義されているコンテナ上で動作しています
* コンテナ間接続はDooD方式となっており、起動されたコンテナにブラウザやcurl等で接続する場合はhttp://localhostではなく、http://adminer-bigquery-test:80で接続することに注意してください。
* 同様にDooD形式ですので、google_credentialの場所に注意してください
    * claudeが稼働しているのは`adminer-dev-1`コンテナで、credentialは`/etc/google_credentials.json`にあります
    * 新しくコンテナを作成する場合、ホスト側のcredentialは`~/google_credential.json`に存在します。これはclaude codeが稼働しているコンテナから見ることはできません。適切にvolume mountして利用してください。
* コンテナは既存のadminer-netネットワークにexternalで所属させてください。
* bigqueryのプロジェクトはnyle-carmo-analysisです。
* adminer/の他、plugins/やvendor/もDockerfileでcopyしてください。
* customのindex.phpなど、コンテナに必要なファイルはcontainer/tests/においてください。

# 5. e2eテスト実行
* 起動したコンテナを使って動作確認を行ってください。
* できたこと、できなかったことを報告してください。

# 6. 認証関連の修正
* bigqueryはユーザ名とパスワードではなく、credentialを読み込むことでログインします。
* 認証関連についてはplugins/login-password-less.phpやplugins/login-servers.php、plugins/login-table.phpを参考にしてください。
* ログイン画面を修正し、データベース種類とサーバー(プロジェクトIDを入力)、パスワード(credentialを入力)するようにしてください。
    * ユーザ名とデータベースの入力欄は画面から削除し、なくても問題ないようにindex.phpおよびプラグインを修正してください。
* ログイン後、それらの情報を使ってbigqueryに接続し、次の画面へと進んでください。
