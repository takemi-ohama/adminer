# Playwright MCP ãƒ†ã‚¹ãƒˆæ‰‹é †ã‚¬ã‚¤ãƒ‰

Adminerã®BigQueryãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’Playwright MCPã§æ¤œè¨¼ã™ã‚‹è©³ç´°æ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ æ¦‚è¦

Playwright MCPã¯ã€Claude Codeç’°å¢ƒã‹ã‚‰ãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œã‚’è‡ªå‹•åŒ–ã—ã¦E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
DooD (Docker-outside-of-Docker) ç’°å¢ƒã§ã€ã‚³ãƒ³ãƒ†ãƒŠé–“é€šä¿¡ã‚’æ´»ç”¨ã—ãŸãƒ†ã‚¹ãƒˆãŒå¯èƒ½ã§ã™ã€‚

## ğŸ—ï¸ ç’°å¢ƒæ§‹æˆ

### DooDç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆæ§‹æˆ
```
Claude Codeç’°å¢ƒ (adminer-dev-1)
â”œâ”€â”€ Playwright MCP
â””â”€â”€ å¯¾è±¡: http://adminer-bigquery-test (Webã‚³ãƒ³ãƒ†ãƒŠ)
    â”œâ”€â”€ Port: 80 (å†…éƒ¨é€šä¿¡)
    â”œâ”€â”€ Network: adminer-net
    â””â”€â”€ BigQueryèªè¨¼: /etc/google_credentials.json
```

## ğŸš€ åŸºæœ¬ãƒ†ã‚¹ãƒˆæ‰‹é †

### 1. äº‹å‰æº–å‚™

#### ã‚³ãƒ³ãƒ†ãƒŠçŠ¶æ…‹ç¢ºèª
```bash
# Webã‚³ãƒ³ãƒ†ãƒŠã®ç¨¼åƒç¢ºèª
docker ps | grep adminer-bigquery-test

# ã‚³ãƒ³ãƒ†ãƒŠãŒåœæ­¢ã—ã¦ã„ã‚‹å ´åˆ
cd container/web
docker compose up -d
```

### 2. Playwright MCP åŸºæœ¬æ“ä½œ

#### 2.1 ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒšãƒ¼ã‚¸é·ç§»ï¼‰
```javascript
// åŸºæœ¬çš„ãªãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹
browser_navigate({
  "url": "http://adminer-bigquery-test",
  "expectation": {
    "includeSnapshot": true,
    "snapshotOptions": {"format": "aria", "maxLength": 2000}
  }
})
```

#### 2.2 è¦ç´ ã®ã‚¯ãƒªãƒƒã‚¯æ“ä½œ
```javascript
// ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯
browser_click({
  "selectors": [{"css": "input[value='Login']"}],
  "expectation": {
    "includeSnapshot": true,
    "snapshotOptions": {"format": "aria", "maxLength": 2000}
  }
})
```

#### 2.3 å¾…æ©Ÿå‡¦ç†ï¼ˆé‡è¦ï¼‰
```javascript
// BigQueryèªè¨¼å‡¦ç†ã®å¾…æ©Ÿ
browser_wait_for({
  "time": 3,
  "expectation": {
    "includeSnapshot": true,
    "snapshotOptions": {"format": "aria", "maxLength": 2000}
  }
})
```

#### 2.4 ãƒšãƒ¼ã‚¸çŠ¶æ…‹ã®ç¢ºèª
```javascript
// ç¾åœ¨ã®ãƒšãƒ¼ã‚¸çŠ¶æ³ã‚’ç¢ºèª
browser_snapshot({
  "expectation": {
    "includeSnapshot": true,
    "snapshotOptions": {"format": "aria", "maxLength": 2000}
  }
})
```

### 3. å®Œå…¨ãƒ†ã‚¹ãƒˆãƒ•ãƒ­ãƒ¼ä¾‹

#### Adminer BigQueryãƒ‰ãƒ©ã‚¤ãƒãƒ¼æ¤œè¨¼ãƒ•ãƒ­ãƒ¼
```bash
# æ‰‹é †1: ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹
browser_navigate â†’ http://adminer-bigquery-test

# æ‰‹é †2: è‡ªå‹•èªè¨¼ï¼ˆBigQueryè¨­å®šæ¸ˆã¿ï¼‰
browser_click â†’ Login button

# æ‰‹é †3: èªè¨¼å‡¦ç†å¾…æ©Ÿï¼ˆå¿…é ˆï¼‰
browser_wait_for â†’ 3ç§’

# æ‰‹é †4: ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆè¡¨ç¤ºç¢ºèª
browser_snapshot â†’ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§

# æ‰‹é †5: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é¸æŠ
browser_click â†’ prod_carmo_db

# æ‰‹é †6: ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ç¢ºèª
browser_snapshot â†’ ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ï¼ˆ181ä»¶ï¼‰

# æ‰‹é †7: ãƒ†ãƒ¼ãƒ–ãƒ«è©³ç´°è¡¨ç¤º
browser_click â†’ member_info

# æ‰‹é †8: ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ç¢ºèª
browser_snapshot â†’ ã‚«ãƒ©ãƒ æƒ…å ±

# æ‰‹é †9: ãƒ‡ãƒ¼ã‚¿é¸æŠæ©Ÿèƒ½ç¢ºèª
browser_click â†’ "Select data"
```

## ğŸ¯ ãƒ†ã‚¹ãƒˆå¯¾è±¡æ©Ÿèƒ½

### åŸºæœ¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
- [x] **ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†**: BigQueryã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼
- [x] **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¡¨ç¤º**: GCPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¥ç¶šç¢ºèª
- [x] **ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆä¸€è¦§**: BigQuery Datasetè¡¨ç¤º
- [x] **ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§**: 181å€‹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
- [x] **ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ **: ã‚«ãƒ©ãƒ æƒ…å ±ã€ãƒ‡ãƒ¼ã‚¿å‹è¡¨ç¤º

### UIæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
- [x] **ãƒ‘ãƒ³ããšãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: Google BigQuery â†’ Project â†’ Dataset
- [x] **ãƒªãƒ³ã‚¯æ©Ÿèƒ½**: Show structure, Select data, Alter table
- [x] **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: æ¨©é™åˆ¶é™ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º

## âš¡ é‡è¦ãªæŠ€è¡“ãƒã‚¤ãƒ³ãƒˆ

### 1. ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼æˆ¦ç•¥

#### å•é¡Œ: è¤‡æ•°è¦ç´ ãƒãƒƒãƒã‚¨ãƒ©ãƒ¼
```
Error: strict mode violation: resolved to 2 elements
```

#### è§£æ±ºç­–: å…·ä½“çš„ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã®ä½¿ç”¨
```javascript
// âŒ æ›–æ˜§ãªã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼
{"text": "member_info"}

// âœ… å…·ä½“çš„IDã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼
{"css": "#Table-member_info"}

// âœ… å±æ€§æŒ‡å®šã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼
{"css": "a[href*='select=member_info']"}
```

### 2. éåŒæœŸå‡¦ç†å¯¾å¿œ

#### å•é¡Œ: ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
```
TimeoutError: Timeout 5000ms exceeded
```

#### è§£æ±ºç­–: é©åˆ‡ãªå¾…æ©Ÿå‡¦ç†
```javascript
// BigQueryèªè¨¼å¾Œã¯å¿…ãšå¾…æ©Ÿ
browser_wait_for({"time": 3})

// ãƒšãƒ¼ã‚¸é·ç§»å¾Œã®çŠ¶æ…‹ç¢ºèª
browser_snapshot()
```

### 3. DooDç’°å¢ƒã§ã®æ¥ç¶š

#### æ¥ç¶šå½¢å¼
```bash
# âŒ localhostä½¿ç”¨
http://localhost:8080

# âœ… ã‚³ãƒ³ãƒ†ãƒŠåä½¿ç”¨
http://adminer-bigquery-test
```

## ğŸ” ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¯¾å‡¦æ³•

### 1. èªè¨¼é–¢é€£ã‚¨ãƒ©ãƒ¼

#### ç—‡çŠ¶
```
Unable to select the table.
```

#### åŸå› ã¨å¯¾å‡¦
- **åŸå› **: BigQueryãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ä¸è¶³
- **å¯¾å‡¦**: åˆ¥ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã§æ¤œè¨¼ã€æ¨©é™ç¢ºèª

### 2. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼

#### ç—‡çŠ¶
```
Failed to connect to adminer-bigquery-test
```

#### å¯¾å‡¦æ‰‹é †
```bash
# 1. ã‚³ãƒ³ãƒ†ãƒŠç¨¼åƒç¢ºèª
docker ps | grep adminer-bigquery-test

# 2. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¢ºèª
docker network ls | grep adminer-net

# 3. ã‚³ãƒ³ãƒ†ãƒŠå†èµ·å‹•
cd container/web
docker compose restart
```

### 3. ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã‚¨ãƒ©ãƒ¼

#### ç—‡çŠ¶
```
locator.click: Error: strict mode violation
```

#### å¯¾å‡¦æ‰‹é †
```javascript
// 1. ã‚ˆã‚Šå…·ä½“çš„ãªã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ä½¿ç”¨
{"css": "#specific-id"}

// 2. å±æ€§æŒ‡å®šã§ãƒ¦ãƒ‹ãƒ¼ã‚¯åŒ–
{"css": "a[title='Show structure']"}

// 3. éšå±¤æŒ‡å®šã§çµã‚Šè¾¼ã¿
{"css": "table tbody tr td a"}
```

## ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœã®è©•ä¾¡

### æˆåŠŸåˆ¤å®šåŸºæº–
- [ ] ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ãŒæ­£å¸¸è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] BigQueryèªè¨¼ãŒè‡ªå‹•å®Œäº†ã™ã‚‹
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ï¼ˆ181ä»¶ï¼‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ è©³ç´°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé©åˆ‡ã«è¡¨ç¤ºã•ã‚Œã‚‹

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™
- **ãƒ­ã‚°ã‚¤ãƒ³å¿œç­”æ™‚é–“**: < 5ç§’
- **ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿**: < 3ç§’
- **ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§è¡¨ç¤º**: < 5ç§’
- **ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ è¡¨ç¤º**: < 3ç§’

## ğŸ› ï¸ ãƒ‡ãƒãƒƒã‚°æ‰‹æ³•

### 1. è©³ç´°ãƒ­ã‚°ç¢ºèª
```javascript
// è©³ç´°ãªã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆå–å¾—
browser_snapshot({
  "expectation": {
    "includeSnapshot": true,
    "snapshotOptions": {
      "format": "aria",
      "maxLength": 5000  // ã‚ˆã‚Šè©³ç´°ãªæƒ…å ±
    }
  }
})
```

### 2. æ®µéšçš„æ¤œè¨¼
```javascript
// å„ã‚¹ãƒ†ãƒƒãƒ—ã§ã®çŠ¶æ…‹ç¢ºèª
browser_navigate â†’ browser_snapshot  // ãƒšãƒ¼ã‚¸è¡¨ç¤ºç¢ºèª
browser_click â†’ browser_wait_for â†’ browser_snapshot  // ã‚¯ãƒªãƒƒã‚¯çµæœç¢ºèª
```

### 3. HTMLæ§‹é€ ã®ç¢ºèª
```javascript
// HTMLã‚½ãƒ¼ã‚¹ç¢ºèªï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
browser_inspect_html({
  "selectors": [{"css": "body"}],
  "expectation": {"includeSnapshot": false}
})
```

## ğŸ“ ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œè¨˜éŒ²
```markdown
## ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ—¥æ™‚
2025-09-19 å®Ÿè¡Œ

## æ¤œè¨¼ç’°å¢ƒ
- Claude Codeç’°å¢ƒ: adminer-dev-1
- ãƒ†ã‚¹ãƒˆå¯¾è±¡: adminer-bigquery-test
- BigQueryãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: nyle-carmo-analysis

## ãƒ†ã‚¹ãƒˆçµæœ
âœ… ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†: æˆåŠŸ
âœ… ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆè¡¨ç¤º: æˆåŠŸ
âœ… ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§è¡¨ç¤º: æˆåŠŸï¼ˆ181ä»¶ï¼‰
âœ… ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ è¡¨ç¤º: æˆåŠŸ
âš ï¸ ãƒ‡ãƒ¼ã‚¿é¸æŠæ©Ÿèƒ½: æ¨©é™åˆ¶é™ã«ã‚ˆã‚Šä¸€éƒ¨åˆ¶é™

## ç™ºè¦‹äº‹é …
- BigQueryã®æ¨©é™è¨­å®šã«ã‚ˆã‚‹ä¸€éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™
- èªè¨¼å‡¦ç†ã®éåŒæœŸæ€§ã«ã‚ˆã‚‹é©åˆ‡ãªå¾…æ©Ÿæ™‚é–“ã®å¿…è¦æ€§
```

## ğŸ”„ ç¶™ç¶šçš„ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

### é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¸ã®çµ±åˆ
```bash
# 1. ã‚³ãƒ¼ãƒ‰ä¿®æ­£å¾Œã®è¿…é€Ÿæ¤œè¨¼
cd container/web && docker compose restart

# 2. Playwright MCPã§ã®E2Eãƒ†ã‚¹ãƒˆ
# Claude Codeç’°å¢ƒã§Playwright MCPå®Ÿè¡Œ

# 3. çµæœç¢ºèªã¨æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
```

### è‡ªå‹•åŒ–ã®å¯èƒ½æ€§
```bash
# å°†æ¥çš„ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆåŒ–æ¡ˆ
./test-playwright-mcp.sh
â”œâ”€â”€ Pre-check: ã‚³ãƒ³ãƒ†ãƒŠç¨¼åƒç¢ºèª
â”œâ”€â”€ Execute: Playwright MCP ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
â”œâ”€â”€ Report: çµæœãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
â””â”€â”€ Cleanup: å¿…è¦ã«å¿œã˜ã¦ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
```

---

ã“ã®ã‚¬ã‚¤ãƒ‰ã«å¾“ã£ã¦ã€Playwright MCPã‚’æ´»ç”¨ã—ãŸåŠ¹æœçš„ãªE2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€Adminer BigQueryãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã®å“è³ªã‚’ç¶™ç¶šçš„ã«ä¿è¨¼ã—ã¦ãã ã•ã„ã€‚